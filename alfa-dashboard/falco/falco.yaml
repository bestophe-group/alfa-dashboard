rules_file:
  - /etc/falco/falco_rules.yaml
  - /etc/falco/falco_rules.local.yaml
  - /etc/falco/rules.d

json_output: true
json_include_output_property: true
json_include_tags_property: true

log_stderr: true
log_syslog: false
log_level: info

priority: warning

buffered_outputs: true

syscall_event_drops:
  actions:
    - log
    - alert
  rate: 0.03333
  max_burst: 1

# HTTP output to Falcosidekick
http_output:
  enabled: true
  url: "http://alfa-falcosidekick:2801"
  user_agent: "falco/0.37.0"

stdout_output:
  enabled: true

file_output:
  enabled: false

program_output:
  enabled: false

grpc:
  enabled: false

grpc_output:
  enabled: false

# Webserver for healthcheck
webserver:
  enabled: true
  listen_port: 8765
  k8s_healthz_endpoint: /healthz
  ssl_enabled: false

# Modern eBPF probe
engine:
  kind: modern_ebpf

# Watch config file changes
watch_config_files: true

# Disable driver loading (using modern_ebpf)
driver:
  loader: none
