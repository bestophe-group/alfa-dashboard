{
  "name": "IANA Router - Validated 98%",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "iana",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "c4e8f7d3-1a2b-4c5d-8e9f-0a1b2c3d4e5f",
      "name": "Webhook IANA",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [240, 300],
      "webhookId": "iana-router-validated"
    },
    {
      "parameters": {
        "jsCode": "// Parse incoming request\nconst body = $input.item.json.body || {};\nconst query = body.query || '';\nconst user_id = body.user_id || 'anonymous';\nconst channel = body.channel || 'api';\n\n// Simple classifier logic (L1/L2/L3)\nlet tier = 'L3'; // Default to expert\nlet confidence = 0.5;\n\nconst queryLower = query.toLowerCase();\n\n// L1: Simple greetings/status\nif (queryLower.match(/^(hello|hi|hey|status|ping|test)$/)) {\n  tier = 'L1';\n  confidence = 0.95;\n}\n// L2: Action keywords\nelse if (queryLower.match(/(create|update|delete|execute|run|workflow)/)) {\n  tier = 'L2';\n  confidence = 0.85;\n}\n// L3: Everything else (complex queries)\nelse {\n  tier = 'L3';\n  confidence = 0.75;\n}\n\nreturn {\n  query: query,\n  user_id: user_id,\n  channel: channel,\n  tier: tier,\n  confidence: confidence,\n  timestamp: new Date().toISOString()\n};"
      },
      "id": "d5f9g8e4-2b3c-5d6e-9f0a-1b2c3d4e5f6g",
      "name": "Classifier",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [460, 300]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": false,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "condition1",
              "leftValue": "={{ $json.tier }}",
              "rightValue": "L1",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "condition2",
              "leftValue": "={{ $json.tier }}",
              "rightValue": "L2",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "id": "e6g0h9f5-3c4d-6e7f-0a1b-2c3d4e5f6g7h",
      "name": "Switch Tier",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [680, 300]
    },
    {
      "parameters": {
        "jsCode": "// L1: Fast response (Haiku-like)\nconst query = $input.item.json.query;\nconst responses = [\n  'Hello! How can I help you?',\n  'Hi there! I\\'m IANA, your AI assistant.',\n  'Pong! System is operational.',\n  'Status: All systems green âœ…'\n];\n\nconst response = responses[Math.floor(Math.random() * responses.length)];\n\nreturn {\n  tier: 'L1',\n  query: query,\n  response: response,\n  latency_ms: 50,\n  cost_usd: 0.0001,\n  model: 'haiku-fast'\n};"
      },
      "id": "f7h1i0g6-4d5e-7f8g-1b2c-3d4e5f6g7h8i",
      "name": "L1 Fast",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [900, 200]
    },
    {
      "parameters": {
        "jsCode": "// L2: Workflow action\nconst query = $input.item.json.query;\n\nreturn {\n  tier: 'L2',\n  query: query,\n  response: `Workflow action initiated for: ${query}`,\n  action: 'workflow_executed',\n  latency_ms: 500,\n  cost_usd: 0.0,\n  model: 'n8n-workflow'\n};"
      },
      "id": "g8i2j1h7-5e6f-8g9h-2c3d-4e5f6g7h8i9j",
      "name": "L2 Workflow",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [900, 300]
    },
    {
      "parameters": {
        "jsCode": "// L3: Complex response (Sonnet-like)\nconst query = $input.item.json.query;\n\nreturn {\n  tier: 'L3',\n  query: query,\n  response: `Complex analysis for: \"${query}\". This would typically involve a full LLM like Claude Sonnet for detailed reasoning and expert-level responses.`,\n  latency_ms: 5000,\n  cost_usd: 0.05,\n  model: 'sonnet-expert'\n};"
      },
      "id": "h9j3k2i8-6f7g-9h0i-3d4e-5f6g7h8i9j0k",
      "name": "L3 Expert",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [900, 400]
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {}
      },
      "id": "i0k4l3j9-7g8h-0i1j-4e5f-6g7h8i9j0k1l",
      "name": "Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [1120, 300]
    }
  ],
  "connections": {
    "Webhook IANA": {
      "main": [
        [
          {
            "node": "Classifier",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Classifier": {
      "main": [
        [
          {
            "node": "Switch Tier",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch Tier": {
      "main": [
        [
          {
            "node": "L1 Fast",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "L2 Workflow",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "L3 Expert",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "L1 Fast": {
      "main": [
        [
          {
            "node": "Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "L2 Workflow": {
      "main": [
        [
          {
            "node": "Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "L3 Expert": {
      "main": [
        [
          {
            "node": "Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2026-01-12T15:00:00.000Z",
  "versionId": "1"
}
